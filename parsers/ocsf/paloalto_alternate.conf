{
  // Specify time zone if logs are not UTC
  //timezone: "America/Detroit"
  
  attributes: {
    "dataSource.category": "security",
    "dataSource.name": "Palo Alto Networks",
    "dataSource.vendor": "Palo Alto Networks"
  }
  patterns: {
    timestamp_pat: "\\d{4}\\/\\d{2}\\/\\d{2}.\\d{2}:\\d{2}:\\d{2}", //YYYY/MM/DD HH:MM:SS
    value_pat: "\".*\"|[^,]*", //field value can be a comma-delimited list wrapped in quotes, a single value containing words and spaces, or empty
  }
  formats: [
    // TRAFFIC
    {
      id: "traffic-11-0", //PAN-OS 11.0 TRAFFIC, adds Flow Type and Cluster Name
      attributes: {
        "event.type": "traffic",
        "format": "traffic-v11"
      },
      format: "$network_activity.future_use_1$,$network_activity.receive_time$,$firewall.serial_number$,TRAFFIC,$network_activity.sub_type$,$network_activity.future_use_2$,$timestamp=timestamp_pat$,$src.ip.address$,$dst.ip.address$,$network_endpoint.nat_src_ip$,$network_endpoint.nat_dst_ip$,$rule.name$,$user.src_name$,$user.dst_name$,$network_activity.app_name$,$network_traffic.virtual_system_name$,$source_zone$,$destination_zone$,$network_interface.inbound_name$,$network_interface.outbound_name$,$network_activity.log_action$,$network_activity.future_use_3$,$session.uid$,$network_activity.repeat_count$,$network_endpoint.src_port$,$network_endpoint.dst_port$,$nenetwork_endpoint.nat_src_port$,$nenetwork_endpoint.nat_dst_port$,$network_connection_info.flag$,$network_connection_info.protocol_name$,$network_activity.action$,$network_traffic.bytes$,$network_traffic.bytes_out$,$network_traffic.bytes_in$,$network_traffic.packets$,$network_activity.start_time_dt$,$network_activity.elapsed_time$,$network_activity.category_name$,$network_activity.future_use_4$,$network_activity.sequence_number$,$network_activity.action_flags$,$location.src_country$,$location.dst_country$,$network_activity.future_use_5$,$network_traffic.packets_out$,$network_traffic.packets_in$,$session.expiration_reason$,$device.group_hierarchy.level_1$,$device.group_hierarchy.level_2$,$device.group_hierarchy.level_3$,$device.group_hierarchy.level_4$,$firewall.virtual_system_name$,$device.name$,$network_activity.action_source$,$virtual_machine.src_vm_uuid$,$virtual_machine.dst_vm_uuid$,$device.imsi$,$device.imei$,$session.parent_uid$,$network_activity.parent_start_time_dt$,$network_connection_info.tunnel_type$,$network_connection_info.sctp_id$,$network_connection_info.sctp_chunks$,$network_connection_info.sctp_chunks_out$,$network_connection_info.sctp_chunks_in$,$rule.uid$,$network_activity.http_connection$,$network_connection_info.app_flap_count$,$policy.uid$,$network_connection_info.link_switches$,$network_connection_info.sd_wan_cluster$,$network_connection_info.sd_wan_device_type$,$network_connection_info.sd_wan_cluster_type$,$network_connection_info.sd_wan_site$,$user.groups$,$http_request.x_forwarded_for$,$device.src_type$,$device.src_profile$,$device.src_model$,$device.src_vendor_name$,$device.src_os_edition$,$device.src_os_version$,$network_connection_info.src_hostname$,$device.src_mac$,$device.dst_type$,$device.dst_profile$,$device.dst_model$,$device.dst_vendor_name$,$device.src_os_edition$,$device.src_os_version$,$network_connection_info.dst_hostname$,$network_connection_info.dst_mac$,$container.id$,$container.pod_namespace$,$container.pod_name$,$network_endpoint.src_host_list$,$network_endpoint.dst_host_list$,$network_endpoint.host_id$,$device_hardware_info.serial_number$,$policy.src_group$,$policy.dst_group$,$session.owner$,$network_activity.time$,$network_activity.a_slice.service_type$,$network_activity.a_slice.differentiator$,$network_activity.sub_category$,$network_activity.category_name$,$network_activity.app_model$,$network_activity.severity$,$network_activity.app_characteristic=value_pat$,$network_activity.container.id$,$network_activity.app_tunnel_type$,$network_activity.is_saas$,$network_activity.is_sanctioned$,$network_activity.is_offloaded$,$network_activity.flow_type$,$network_activity.cluster.name$",
      rewrites: [
        {
          input:   "device.name",
          output:  "event.source",
          match:   ".*",
          replace: "$0"
        }
      ],
      halt: true
    }, {
      id: "traffic-10-2", //PAN-OS 10.2 TRAFFIC, adds numerous fields after Dynamic User Group Name
      attributes: {
        "event.type": "traffic",
        "format": "traffic-v10.2"
      },
      format: "$network_activity.future_use_1$,$network_activity.receive_time$,$firewall.serial_number$,TRAFFIC,$network_activity.sub_type$,$network_activity.future_use_2$,$timestamp=timestamp_pat$,$src.ip.address$,$dst.ip.address$,$network_endpoint.nat_src_ip$,$network_endpoint.nat_dst_ip$,$rule.name$,$user.src_name$,$user.dst_name$,$network_activity.app_name$,$network_traffic.virtual_system_name$,$source_zone$,$destination_zone$,$network_interface.inbound_name$,$network_interface.outbound_name$,$network_activity.log_action$,$network_activity.future_use_3$,$session.uid$,$network_activity.repeat_count$,$network_endpoint.src_port$,$network_endpoint.dst_port$,$nenetwork_endpoint.nat_src_port$,$nenetwork_endpoint.nat_dst_port$,$network_connection_info.flag$,$network_connection_info.protocol_name$,$network_activity.action$,$network_traffic.bytes$,$network_traffic.bytes_out$,$network_traffic.bytes_in$,$network_traffic.packets$,$network_activity.start_time_dt$,$network_activity.elapsed_time$,$network_activity.category_name$,$network_activity.future_use_4$,$network_activity.sequence_number$,$network_activity.action_flags$,$location.src_country$,$location.dst_country$,$network_activity.future_use_5$,$network_traffic.packets_out$,$network_traffic.packets_in$,$session.expiration_reason$,$device.group_hierarchy.level_1$,$device.group_hierarchy.level_2$,$device.group_hierarchy.level_3$,$device.group_hierarchy.level_4$,$firewall.virtual_system_name$,$device.name$,$network_activity.action_source$,$virtual_machine.src_vm_uuid$,$virtual_machine.dst_vm_uuid$,$device.imsi$,$device.imei$,$session.parent_uid$,$network_activity.parent_start_time_dt$,$network_connection_info.tunnel_type$,$network_connection_info.sctp_id$,$network_connection_info.sctp_chunks$,$network_connection_info.sctp_chunks_out$,$network_connection_info.sctp_chunks_in$,$rule.uid$,$network_activity.http_connection$,$network_connection_info.app_flap_count$,$policy.uid$,$network_connection_info.link_switches$,$network_connection_info.sd_wan_cluster$,$network_connection_info.sd_wan_device_type$,$network_connection_info.sd_wan_cluster_type$,$network_connection_info.sd_wan_site$,$user.groups$,$http_request.x_forwarded_for$,$device.src_type$,$device.src_profile$,$device.src_model$,$device.src_vendor_name$,$device.src_os_edition$,$device.src_os_version$,$network_connection_info.src_hostname$,$device.src_mac$,$device.dst_type$,$device.dst_profile$,$device.dst_model$,$device.dst_vendor_name$,$device.src_os_edition$,$device.src_os_version$,$network_connection_info.dst_hostname$,$network_connection_info.dst_mac$,$container.id$,$container.pod_namespace$,$container.pod_name$,$network_endpoint.src_host_list$,$network_endpoint.dst_host_list$,$network_endpoint.host_id$,$device_hardware_info.serial_number$,$policy.src_group$,$policy.dst_group$,$session.owner$,$network_activity.time$,$network_activity.a_slice.service_type$,$network_activity.a_slice.differentiator$,$network_activity.sub_category$,$network_activity.category_name$,$network_activity.app_model$,$network_activity.severity$,$network_activity.app_characteristic=value_pat$,$network_activity.container.id$,$network_activity.app_tunnel_type$,$network_activity.is_saas$,$network_activity.is_sanctioned$,$network_activity.is_offloaded$",
      rewrites: [
        {
          input:   "device.name",
          output:  "event.source",
          match:   ".*",
          replace: "$0"
        }
      ],
      halt: true
    }, {
      id: "traffic-9-1", //PAN-OS 9.1 TRAFFIC
      attribute: {
        "event.type": "traffic",
        "format": "traffic-v9.1"
      },
      format: "$network_activity.future_use_1$,$network_activity.receive_time$,$firewall.serial_number$,TRAFFIC,$network_activity.sub_type$,$network_activity.future_use_2$,$timestamp=timestamp_pat$,$src.ip.address$,$dst.ip.address$,$network_endpoint.nat_src_ip$,$network_endpoint.nat_dst_ip$,$rule.name$,$user.src_name$,$user.dst_name$,$network_activity.app_name$,$network_traffic.virtual_system_name$,$source_zone$,$destination_zone$,$network_interface.inbound_name$,$network_interface.outbound_name$,$network_activity.log_action$,$network_activity.future_use_3$,$session.uid$,$network_activity.repeat_count$,$network_endpoint.src_port$,$network_endpoint.dst_port$,$nenetwork_endpoint.nat_src_port$,$nenetwork_endpoint.nat_dst_port$,$network_connection_info.flag$,$network_connection_info.protocol_name$,$network_activity.action$,$network_traffic.bytes$,$network_traffic.bytes_out$,$network_traffic.bytes_in$,$network_traffic.packets$,$network_activity.start_time_dt$,$network_activity.elapsed_time$,$network_activity.category_name$,$network_activity.future_use_4$,$network_activity.sequence_number$,$network_activity.action_flags$,$location.src_country$,$location.dst_country$,$network_activity.future_use_5$,$network_traffic.packets_out$,$network_traffic.packets_in$,$session.expiration_reason$,$device.group_hierarchy.level_1$,$device.group_hierarchy.level_2$,$device.group_hierarchy.level_3$,$device.group_hierarchy.level_4$,$firewall.virtual_system_name$,$device.name$,$network_activity.action_source$,$virtual_machine.src_vm_uuid$,$virtual_machine.dst_vm_uuid$,$device.imsi$,$device.imei$,$session.parent_uid$,$network_activity.parent_start_time_dt$,$network_connection_info.tunnel_type$,$network_connection_info.sctp_id$,$network_connection_info.sctp_chunks$,$network_connection_info.sctp_chunks_out$,$network_connection_info.sctp_chunks_in$,$rule.uid$,$network_activity.http_connection$,$network_connection_info.app_flap_count$,$policy.uid$,$network_connection_info.link_switches$,$network_connection_info.sd_wan_cluster$,$network_connection_info.sd_wan_device_type$,$network_connection_info.sd_wan_cluster_type$,$network_connection_info.sd_wan_site$,$user.groups$",
      rewrites: [
        {
          input:   "device.name",
          output:  "event.source",
          match:   ".*",
          replace: "$0"
        }
      ],
      halt: true
    },
    // THREAT
    {
      id: "threat-11-0", //PAN-OS 11.0 THREAT, adds Cluster Name and Flow Type
      attributes: {
        "event.type": "threat",
        "format": "threat-v11"
      },
      format: "$network_activity.future_use_1$,$network_activity.receive_time$,$firewall.serial_number$,THREAT,$network_activity.sub_type$,$network_activity.future_use_2$,$timestamp=timestamp_pat$,$src.ip.address$,$dst.ip.address$,$network_endpoint.nat_src_ip$,$network_endpoint.nat_dst_ip$,$rule.name$,$user.src_name$,$user.dst_name$,$network_activity.app_name$,$network_traffic.virtual_system_name$,$source_zone$,$destination_zone$,$network_interface.inbound_name$,$network_interface.outbound_name$,$network_activity.log_action$,$network_activity.future_use_3$,$session.uid$,$network_activity.repeat_count$,$network_endpoint.src_port$,$network_endpoint.dst_port$,$nenetwork_endpoint.nat_src_port$,$nenetwork_endpoint.nat_dst_port$,$network_connection_info.flag$,$network_connection_info.protocol_name$,$network_activity.action$,$url.filename=value_pat$,$cwe.uid$,$network_activity.category_name$,$severity$,$direction$,$network_activity.sequence_number$,$network_activity.action_flags$,$location.src_location$,$location.dst_location$,$misc$,$Content_type$,$pcap.id$,$file_digest$,$cloud$,$url.index$,$user_agent$,$file_type$,$x-forwarded-for$,$referer$,$sender$,$subject$,$recipient$,$report.id$,$device.group_hierarchy.level_1$,$device.group_hierarchy.level_2$,$device.group_hierarchy.level_3$,$device.group_hierarchy.level_4$,$firewall.virtual_system_name$,$device.name$,$network_activity.future_use_4$,$virtual_machine.src_vm_uuid$,$virtual_machine.dst_vm_uuid$,$http_method$,$device.imsi$,$device.imei$,$session.parent_uid$,$network_activity.parent_start_time_dt$,$network_connection_info.tunnel_type$,$cwe.caption$,$content_version$,$network_activity.future_use_5$,$network_activity.sctp_association_id$,$network_connection_info.protocol_name$,$http_header$,$url.category_list=value_pat$,$rule.uid$,$network_activity.http_connection$,$user.groups$,$http_request.x_forwarded_for$,$device.src_type$,$device.src_profile$,$device.src_model$,$device.src_vendor_name$,$device.src_os_edition$,$device.src_os_version$,$network_connection_info.src_hostname$,$device.src_mac$,$device.dst_type$,$device.dst_profile$,$device.dst_model$,$device.dst_vendor_name$,$device.src_os_edition$,$device.src_os_version$,$network_connection_info.dst_hostname$,$network_connection_info.dst_mac$,$container.id$,$container.pod_namespace$,$container.pod_name$,$network_endpoint.src_host_list$,$network_endpoint.dst_host_list$,$network_endpoint.host_id$,$device_hardware_info.serial_number$,$domain_edl$,$policy.src_group$,$policy.dst_group$,$partial_hash$,$network_activity.time$,$reason$,$justification$,$network_activity.a_slice.service_type$,$network_activity.sub_category$,$network_activity.category_name$,$network_activity.app_model$,$network_activity.severity$,$network_activity.app_characteristic=value_pat$,$network_activity.container.id$,$network_activity.app_tunnel_type$,$network_activity.is_saas$,$network_activity.is_sanctioned$,$cloud_report_id$,$network_activity.cluster.name$,$network_activity.flow_type$",
      rewrites: [
        {
          input:   "device.name",
          output:  "event.source",
          match:   ".*",
          replace: "$0"
        }
      ],
      halt: true
    }, {
      id: "threat-10-2", //PAN-OS 10.2 THREAT, adds Cloud Report ID
      attributes: {
        "event.type": "threat",
        "format": "threat-v10.2"
      },
      format: "$network_activity.future_use_1$,$network_activity.receive_time$,$firewall.serial_number$,THREAT,$network_activity.sub_type$,$network_activity.future_use_2$,$timestamp=timestamp_pat$,$src.ip.address$,$dst.ip.address$,$network_endpoint.nat_src_ip$,$network_endpoint.nat_dst_ip$,$rule.name$,$user.src_name$,$user.dst_name$,$network_activity.app_name$,$network_traffic.virtual_system_name$,$source_zone$,$destination_zone$,$network_interface.inbound_name$,$network_interface.outbound_name$,$network_activity.log_action$,$network_activity.future_use_3$,$session.uid$,$network_activity.repeat_count$,$network_endpoint.src_port$,$network_endpoint.dst_port$,$nenetwork_endpoint.nat_src_port$,$nenetwork_endpoint.nat_dst_port$,$network_connection_info.flag$,$network_connection_info.protocol_name$,$network_activity.action$,$url.filename=value_pat$,$cwe.uid$,$network_activity.category_name$,$severity$,$direction$,$network_activity.sequence_number$,$network_activity.action_flags$,$location.src_location$,$location.dst_location$,$misc$,$Content_type$,$pcap.id$,$file_digest$,$cloud$,$url.index$,$user_agent$,$file_type$,$x-forwarded-for$,$referer$,$sender$,$subject$,$recipient$,$report.id$,$device.group_hierarchy.level_1$,$device.group_hierarchy.level_2$,$device.group_hierarchy.level_3$,$device.group_hierarchy.level_4$,$firewall.virtual_system_name$,$device.name$,$network_activity.future_use_4$,$virtual_machine.src_vm_uuid$,$virtual_machine.dst_vm_uuid$,$http_method$,$device.imsi$,$device.imei$,$session.parent_uid$,$network_activity.parent_start_time_dt$,$network_connection_info.tunnel_type$,$cwe.caption$,$content_version$,$network_activity.future_use_5$,$network_activity.sctp_association_id$,$network_connection_info.protocol_name$,$http_header$,$url.category_list=value_pat$,$rule.uid$,$network_activity.http_connection$,$user.groups$,$http_request.x_forwarded_for$,$device.src_type$,$device.src_profile$,$device.src_model$,$device.src_vendor_name$,$device.src_os_edition$,$device.src_os_version$,$network_connection_info.src_hostname$,$device.src_mac$,$device.dst_type$,$device.dst_profile$,$device.dst_model$,$device.dst_vendor_name$,$device.src_os_edition$,$device.src_os_version$,$network_connection_info.dst_hostname$,$network_connection_info.dst_mac$,$container.id$,$container.pod_namespace$,$container.pod_name$,$network_endpoint.src_host_list$,$network_endpoint.dst_host_list$,$network_endpoint.host_id$,$device_hardware_info.serial_number$,$domain_edl$,$policy.src_group$,$policy.dst_group$,$partial_hash$,$network_activity.time$,$reason$,$justification$,$network_activity.a_slice.service_type$,$network_activity.sub_category$,$network_activity.category_name$,$network_activity.app_model$,$network_activity.severity$,$network_activity.app_characteristic=value_pat$,$network_activity.container.id$,$network_activity.app_tunnel_type$,$network_activity.is_saas$,$network_activity.is_sanctioned$,$cloud_report_id$",
      rewrites: [
        {
          input:   "device.name",
          output:  "event.source",
          match:   ".*",
          replace: "$0"
        }
      ],
      halt: true
    }, {
      id: "threat-10-1", //PAN-OS 10.1 THREAT, adds numerous fields after XFF Address
      attributes: {
        "event.type": "threat",
        "format": "threat-v10.1"
      },
      format: "$network_activity.future_use_1$,$network_activity.receive_time$,$firewall.serial_number$,THREAT,$network_activity.sub_type$,$network_activity.future_use_2$,$timestamp=timestamp_pat$,$src.ip.address$,$dst.ip.address$,$network_endpoint.nat_src_ip$,$network_endpoint.nat_dst_ip$,$rule.name$,$user.src_name$,$user.dst_name$,$network_activity.app_name$,$network_traffic.virtual_system_name$,$source_zone$,$destination_zone$,$network_interface.inbound_name$,$network_interface.outbound_name$,$network_activity.log_action$,$network_activity.future_use_3$,$session.uid$,$network_activity.repeat_count$,$network_endpoint.src_port$,$network_endpoint.dst_port$,$nenetwork_endpoint.nat_src_port$,$nenetwork_endpoint.nat_dst_port$,$network_connection_info.flag$,$network_connection_info.protocol_name$,$network_activity.action$,$url.filename=value_pat$,$cwe.uid$,$network_activity.category_name$,$severity$,$direction$,$network_activity.sequence_number$,$network_activity.action_flags$,$location.src_location$,$location.dst_location$,$misc$,$Content_type$,$pcap.id$,$file_digest$,$cloud$,$url.index$,$user_agent$,$file_type$,$x-forwarded-for$,$referer$,$sender$,$subject$,$recipient$,$report.id$,$device.group_hierarchy.level_1$,$device.group_hierarchy.level_2$,$device.group_hierarchy.level_3$,$device.group_hierarchy.level_4$,$firewall.virtual_system_name$,$device.name$,$network_activity.future_use_4$,$virtual_machine.src_vm_uuid$,$virtual_machine.dst_vm_uuid$,$http_method$,$device.imsi$,$device.imei$,$session.parent_uid$,$network_activity.parent_start_time_dt$,$network_connection_info.tunnel_type$,$cwe.caption$,$content_version$,$network_activity.future_use_5$,$network_activity.sctp_association_id$,$network_connection_info.protocol_name$,$http_header$,$url.category_list=value_pat$,$rule.uid$,$network_activity.http_connection$,$user.groups$,$http_request.x_forwarded_for$,$device.src_type$,$device.src_profile$,$device.src_model$,$device.src_vendor_name$,$device.src_os_edition$,$device.src_os_version$,$network_connection_info.src_hostname$,$device.src_mac$,$device.dst_type$,$device.dst_profile$,$device.dst_model$,$device.dst_vendor_name$,$device.src_os_edition$,$device.src_os_version$,$network_connection_info.dst_hostname$,$network_connection_info.dst_mac$,$container.id$,$container.pod_namespace$,$container.pod_name$,$network_endpoint.src_host_list$,$network_endpoint.dst_host_list$,$network_endpoint.host_id$,$device_hardware_info.serial_number$,$domain_edl$,$policy.src_group$,$policy.dst_group$,$partial_hash$,$network_activity.time$,$reason$,$justification$,$network_activity.a_slice.service_type$,$network_activity.sub_category$,$network_activity.category_name$,$network_activity.app_model$,$network_activity.severity$,$network_activity.app_characteristic=value_pat$,$network_activity.container.id$,$network_activity.app_tunnel_type$,$network_activity.is_saas$,$network_activity.is_sanctioned$"
      rewrites: [
        {
          input:   "device.name",
          output:  "event.source",
          match:   ".*",
          replace: "$0"
        }
      ],
      halt: true
    }, {
      id: "threat-9-1-a", //PAN-OS 9.1 THREAT
      attributes: {
        "event.type": "threat",
        "format": "threat-v9.1-a"
      },
      format: "$network_activity.future_use_1$,$network_activity.receive_time$,$firewall.serial_number$,THREAT,$network_activity.sub_type$,$network_activity.future_use_2$,$timestamp=timestamp_pat$,$src.ip.address$,$dst.ip.address$,$network_endpoint.nat_src_ip$,$network_endpoint.nat_dst_ip$,$rule.name$,$user.src_name$,$user.dst_name$,$network_activity.app_name$,$network_traffic.virtual_system_name$,$source_zone$,$destination_zone$,$network_interface.inbound_name$,$network_interface.outbound_name$,$network_activity.log_action$,$network_activity.future_use_3$,$session.uid$,$network_activity.repeat_count$,$network_endpoint.src_port$,$network_endpoint.dst_port$,$nenetwork_endpoint.nat_src_port$,$nenetwork_endpoint.nat_dst_port$,$network_connection_info.flag$,$network_connection_info.protocol_name$,$network_activity.action$,$url.filename=value_pat$,$cwe.uid$,$network_activity.category_name$,$severity$,$direction$,$network_activity.sequence_number$,$network_activity.action_flags$,$location.src_location$,$location.dst_location$,$misc$,$Content_type$,$pcap.id$,$file_digest$,$cloud$,$url.index$,$user_agent$,$file_type$,$x-forwarded-for$,$referer$,$sender$,$subject$,$recipient$,$report.id$,$device.group_hierarchy.level_1$,$device.group_hierarchy.level_2$,$device.group_hierarchy.level_3$,$device.group_hierarchy.level_4$,$firewall.virtual_system_name$,$device.name$,$network_activity.future_use_4$,$virtual_machine.src_vm_uuid$,$virtual_machine.dst_vm_uuid$,$http_method$,$device.imsi$,$device.imei$,$session.parent_uid$,$network_activity.parent_start_time_dt$,$network_connection_info.tunnel_type$,$cwe.caption$,$content_version$,$network_activity.future_use_5$,$network_activity.sctp_association_id$,$network_connection_info.protocol_name$,$http_header$,$url.category_list=value_pat$,$rule.uid$,$network_activity.http_connection$,$user.groups$"
      rewrites: [
        {
          input:   "device.name",
          output:  "event.source",
          match:   ".*",
          replace: "$0"
        }
      ],
      halt: true
    }, {
      id: "threat-9-1-b", //PAN-OS 9.1 THREAT without Dynamic User Group Name
      attributes: {
        "event.type": "threat",
        "format": "threat-v9.1-b"
      },
      format: "$network_activity.future_use_1$,$network_activity.receive_time$,$firewall.serial_number$,THREAT,$network_activity.sub_type$,$network_activity.future_use_2$,$timestamp=timestamp_pat$,$src.ip.address$,$dst.ip.address$,$network_endpoint.nat_src_ip$,$network_endpoint.nat_dst_ip$,$rule.name$,$user.src_name$,$user.dst_name$,$network_activity.app_name$,$network_traffic.virtual_system_name$,$source_zone$,$destination_zone$,$network_interface.inbound_name$,$network_interface.outbound_name$,$network_activity.log_action$,$network_activity.future_use_3$,$session.uid$,$network_activity.repeat_count$,$network_endpoint.src_port$,$network_endpoint.dst_port$,$nenetwork_endpoint.nat_src_port$,$nenetwork_endpoint.nat_dst_port$,$network_connection_info.flag$,$network_connection_info.protocol_name$,$network_activity.action$,$url.filename=value_pat$,$cwe.uid$,$network_activity.category_name$,$severity$,$direction$,$network_activity.sequence_number$,$network_activity.action_flags$,$location.src_location$,$location.dst_location$,$misc$,$Content_type$,$pcap.id$,$file_digest$,$cloud$,$url.index$,$user_agent$,$file_type$,$x-forwarded-for$,$referer$,$sender$,$subject$,$recipient$,$report.id$,$device.group_hierarchy.level_1$,$device.group_hierarchy.level_2$,$device.group_hierarchy.level_3$,$device.group_hierarchy.level_4$,$firewall.virtual_system_name$,$device.name$,$network_activity.future_use_4$,$virtual_machine.src_vm_uuid$,$virtual_machine.dst_vm_uuid$,$http_method$,$device.imsi$,$device.imei$,$session.parent_uid$,$network_activity.parent_start_time_dt$,$network_connection_info.tunnel_type$,$cwe.caption$,$content_version$,$network_activity.future_use_5$,$network_activity.sctp_association_id$,$network_connection_info.protocol_name$,$http_header$,$url.category_list=value_pat$,$rule.uid$,$network_activity.http_connection$"
      rewrites: [
        {
          input:   "device.name",
          output:  "event.source",
          match:   ".*",
          replace: "$0"
        }
      ],
      halt: true
    },
    // CONFIG
    {
      id: "config-10-1", //PAN-OS v10.1-v11.0 CONFIG, adds Future Use 3 and High Resolution Timestamp
      attributes: {
        "event.type": "config",
        "format": "config-v10.1+"
      },
      format: "$network_activity.future_use_1$,$network_activity.receive_time$,$firewall.serial_number$,CONFIG,$network_activity.sub_type$,$network_activity.future_use_2$,$timestamp=timestamp_pat$,$host_name$,$network_traffic.virtual_system_name$,$command=value_pat$,$admin$,$client$,$result$,$configuration_path$,$before_change_detail$,$after_change_detail$,$device.group_hierarchy.level_1$,$device.group_hierarchy.level_2$,$device.group_hierarchy.level_3$,$device.group_hierarchy.level_4$,$firewall.virtual_system_name$,$device.name$,$device.group$,$audit_comment=value_pat$,$network_activity.future_use_3$,$network_activity.time$",
      rewrites: [
        {
          input:   "device.name",
          output:  "event.source",
          match:   ".*",
          replace: "$0"
        }
      ],
      halt: true
    }, {
      id: "config-9-1", //PAN-OS v9.1 CONFIG
      attributes: {
        "event.type": "config",
        "format": "config-v9.1"
      },
      format: "$network_activity.future_use_1$,$network_activity.receive_time$,$firewall.serial_number$,CONFIG,$network_activity.sub_type$,$network_activity.future_use_2$,$timestamp=timestamp_pat$,$host_name$,$network_traffic.virtual_system_name$,$command=value_pat$,$admin$,$client$,$result$,$configuration_path$,$before_change_detail$,$after_change_detail$,$device.group_hierarchy.level_1$,$device.group_hierarchy.level_2$,$device.group_hierarchy.level_3$,$device.group_hierarchy.level_4$,$firewall.virtual_system_name$,$device.name$,$device.group$,$audit_comment=value_pat$",
      rewrites: [
        {
          input:   "device.name",
          output:  "event.source",
          match:   ".*",
          replace: "$0"
        }
      ],
      halt: true
    },
    // SYSTEM
    {
      id: "config-10-1", //PAN-OS v10.1-v11.0 SYSTEM, adds Future Use 5 & 6 and High Resolution Timestamp
      attributes: {
        "event.type": "system",
        "format": "system-v11.0"
      },
      format: "$network_activity.future_use_1$,$network_activity.receive_time$,$firewall.serial_number$,SYSTEM,$network_activity.sub_type$,$network_activity.future_use_2$,$timestamp=timestamp_pat$,$network_traffic.virtual_system_name$,$session.parent_uid$,$object$,$network_activity.future_use_3$,$network_activity.future_use_4$,$module$,$severity$,$description$,$network_activity.sequence_number$,$network_activity.action_flags$,$device.group_hierarchy.level_1$,$device.group_hierarchy.level_2$,$device.group_hierarchy.level_3$,$device.group_hierarchy.level_4$,$firewall.virtual_system_name$,$device.name$,$network_activity.future_use_5$,$network_activity.future_use_6$,$network_activity.time$",
      rewrites: [
        {
          input:   "device.name",
          output:  "event.source",
          match:   ".*",
          replace: "$0"
        }
      ],
      halt: true
    }, {
      id: "config-10-1", //PAN-OS v9.1 SYSTEM
      attributes: {
        "event.type": "system",
        "format": "system-v9.1"
      },
      format: "$network_activity.future_use_1$,$network_activity.receive_time$,$firewall.serial_number$,SYSTEM,$network_activity.sub_type$,$network_activity.future_use_2$,$timestamp=timestamp_pat$,$network_traffic.virtual_system_name$,$session.parent_uid$,$object$,$network_activity.future_use_3$,$network_activity.future_use_4$,$module$,$severity$,$description$,$network_activity.sequence_number$,$network_activity.action_flags$,$device.group_hierarchy.level_1$,$device.group_hierarchy.level_2$,$device.group_hierarchy.level_3$,$device.group_hierarchy.level_4$,$firewall.virtual_system_name$,$device.name$",
      rewrites: [
        {
          input:   "device.name",
          output:  "event.source",
          match:   ".*",
          replace: "$0"
        }
      ],
      halt: true
    },
    // HIP-MATCH
    {
      id: "hipmatch-11-0", //PAN-OS v11.0 HIPMATCH, adds Cluster Name
      attributes: {
        "event.type": "hipmatch",
        "format": "hiptmatch-v11.0"
      },
      format: "$network_activity.future_use_1$,$network_activity.receive_time$,$firewall.serial_number$,HIP-MATCH,$network_activity.sub_type$,$network_activity.future_use_2$,$timestamp=timestamp_pat$,$user.src_name$,$network_traffic.virtual_system_name$,$machine_name$,$os$,$src.ip.address$,$hip$,$network_activity.repeat_count$,$hip_type$,$network_activity.future_use_2$,$network_activity.future_use_3$,$network_activity.sequence_number$,$network_activity.action_flags$,$device.group_hierarchy.level_1$,$device.group_hierarchy.level_2$,$device.group_hierarchy.level_3$,$device.group_hierarchy.level_4$,$firewall.virtual_system_name$,$device.name$,$firewall.virtual_system_id$,$ipv6_source_address$,$network_endpoint.host_id$,$user_device_serial_number$,$device_mac_address$,$network_activity.time$,$network_activity.cluster.name$",
      rewrites: [
        {
          input:   "device.name",
          output:  "event.source",
          match:   ".*",
          replace: "$0"
        }
      ],
      halt: true
    }, {
      id: "hipmatch-10-1", //PAN-OS v10.1-10.2 HIPMATCH, adds Device MAC Address and High Resolution Timestamp
      attributes: {
        "event.type": "hipmatch",
        "format": "hiptmatch-v9.1"
      },
      format: "$network_activity.future_use_1$,$network_activity.receive_time$,$firewall.serial_number$,HIP-MATCH,$network_activity.sub_type$,$network_activity.future_use_2$,$timestamp=timestamp_pat$,$user.src_name$,$network_traffic.virtual_system_name$,$machine_name$,$os$,$src.ip.address$,$hip$,$network_activity.repeat_count$,$hip_type$,$network_activity.future_use_2$,$network_activity.future_use_3$,$network_activity.sequence_number$,$network_activity.action_flags$,$device.group_hierarchy.level_1$,$device.group_hierarchy.level_2$,$device.group_hierarchy.level_3$,$device.group_hierarchy.level_4$,$firewall.virtual_system_name$,$device.name$,$firewall.virtual_system_id$,$ipv6_source_address$,$network_endpoint.host_id$,$user_device_serial_number$,$device_mac_address$,$network_activity.time$",
      rewrites: [
        {
          input:   "device.name",
          output:  "event.source",
          match:   ".*",
          replace: "$0"
        }
      ],
      halt: true
    }, {
      id: "hipmatch-9-1", //PAN-OS v9.1 HIPMATCH
      attributes: {
        "event.type": "hipmatch",
        "format": "hiptmatch-v9.1"
      },
      format: "$network_activity.future_use_1$,$network_activity.receive_time$,$firewall.serial_number$,HIP-MATCH,$network_activity.sub_type$,$network_activity.future_use_2$,$timestamp=timestamp_pat$,$user.src_name$,$network_traffic.virtual_system_name$,$machine_name$,$os$,$src.ip.address$,$hip$,$network_activity.repeat_count$,$hip_type$,$network_activity.future_use_2$,$network_activity.future_use_3$,$network_activity.sequence_number$,$network_activity.action_flags$,$device.group_hierarchy.level_1$,$device.group_hierarchy.level_2$,$device.group_hierarchy.level_3$,$device.group_hierarchy.level_4$,$firewall.virtual_system_name$,$device.name$,$firewall.virtual_system_id$,$ipv6_source_address$,$network_endpoint.host_id$,$user_device_serial_number$",
      rewrites: [
        {
          input:   "device.name",
          output:  "event.source",
          match:   ".*",
          replace: "$0"
        }
      ],
      halt: true
    },
    // CORRELATION
    {
      id: "correlation", //PAN-OS v9.1-11.0 CORRELATION
      attributes: {
        "event.type": "correlation",
        "format": "correlation"
      },
      format: "$network_activity.future_use_1$,$network_activity.receive_time$,$firewall.serial_number$,CORRELATION,$network_activity.sub_type$,$network_activity.future_use_2$,$timestamp=timestamp_pat$,$src.ip.address$,$user.src_name$,$network_traffic.virtual_system_name$,$network_activity.category_name$,$severity$,$device.group_hierarchy.level_1$,$device.group_hierarchy.level_2$,$device.group_hierarchy.level_3$,$device.group_hierarchy.level_4$,$firewall.virtual_system_name$,$device.name$,$firewall.virtual_system_id$,$object_name$,$object_id$,$evidence$",
      rewrites: [
        {
          input:   "device.name",
          output:  "event.source",
          match:   ".*",
          replace: "$0"
        }
      ],
      halt: true
    },
    // USER ID
    {
      id: "userid-11-0", //PAN-OS v11.0 USERID, adds Origin Data Source, Future Use 3 and Cluster Name
      attributes: {
        "event.type": "userid",
        "format": "userid-v11.0"
      },
      format: "$network_activity.future_use_1$,$network_activity.receive_time$,$firewall.serial_number$,USERID,$network_activity.sub_type$,$network_activity.future_use_2$,$timestamp=timestamp_pat$,$network_traffic.virtual_system_name$,$src.ip.address$,$user$,$data_source_name$,$session.parent_uid$,$network_activity.repeat_count$,$time_out_threshold$,$network_endpoint.src_port$,$network_endpoint.dst_port$,$data_source$,$data_source_type$,$network_activity.sequence_number$,$network_activity.action_flags$,$device.group_hierarchy.level_1$,$device.group_hierarchy.level_2$,$device.group_hierarchy.level_3$,$device.group_hierarchy.level_4$,$firewall.virtual_system_name$,$device.name$,$firewall.virtual_system_id$,$factor_type$,$factor_completion_time$,$factor_number$,$user.groups$,$user_by_source$,$network_activity.tag$,$network_activity.time$,$origin_data_source$,$future_use3$,$network_activity.cluster.name$",
      rewrites: [
        {
          input:   "device.name",
          output:  "event.source",
          match:   ".*",
          replace: "$0"
        }
      ],
      halt: true
    }, {
      id: "userid-10-1", //PAN-OS v10.1-10.2 USERID, adds Tag Name and High Resolution Timestamp
      attributes: {
        "event.type": "userid",
        "format": "userid-v10.1"
      },
      format: "$network_activity.future_use_1$,$network_activity.receive_time$,$firewall.serial_number$,USERID,$network_activity.sub_type$,$network_activity.future_use_2$,$timestamp=timestamp_pat$,$network_traffic.virtual_system_name$,$src.ip.address$,$user$,$data_source_name$,$session.parent_uid$,$network_activity.repeat_count$,$time_out_threshold$,$network_endpoint.src_port$,$network_endpoint.dst_port$,$data_source$,$data_source_type$,$network_activity.sequence_number$,$network_activity.action_flags$,$device.group_hierarchy.level_1$,$device.group_hierarchy.level_2$,$device.group_hierarchy.level_3$,$device.group_hierarchy.level_4$,$firewall.virtual_system_name$,$device.name$,$firewall.virtual_system_id$,$factor_type$,$factor_completion_time$,$factor_number$,$user.groups$,$user_by_source$,$network_activity.tag$,$network_activity.time$",
      rewrites: [
        {
          input:   "device.name",
          output:  "event.source",
          match:   ".*",
          replace: "$0"
        }
      ],
      halt: true
    }, {
      id: "userid-10-1", //PAN-OS v9.1 USERID
      attributes: {
        "event.type": "userid",
        "format": "userid-v9.1"
      },
      format: "$network_activity.future_use_1$,$network_activity.receive_time$,$firewall.serial_number$,USERID,$network_activity.sub_type$,$network_activity.future_use_2$,$timestamp=timestamp_pat$,$network_traffic.virtual_system_name$,$src.ip.address$,$user$,$data_source_name$,$session.parent_uid$,$network_activity.repeat_count$,$time_out_threshold$,$network_endpoint.src_port$,$network_endpoint.dst_port$,$data_source$,$data_source_type$,$network_activity.sequence_number$,$network_activity.action_flags$,$device.group_hierarchy.level_1$,$device.group_hierarchy.level_2$,$device.group_hierarchy.level_3$,$device.group_hierarchy.level_4$,$firewall.virtual_system_name$,$device.name$,$firewall.virtual_system_id$,$factor_type$,$factor_completion_time$,$factor_number$,$user.groups$,$user_by_source$,$network_activity.tag$,$network_activity.time$",
      rewrites: [
        {
          input:   "device.name",
          output:  "event.source",
          match:   ".*",
          replace: "$0"
        }
      ],
      halt: true
    },
    // GLOBALPROTECT
    {
      id: "globalprotect-9-1-3", //PAN-OS v9.1.3+ GLOBALPROTECT, different format
      attributes: {
        "event.type": "globalprotect",
        "format": "globalprotect-v9.1.3"
      },
      format: "$network_activity.future_use_1$,$network_activity.receive_time$,$firewall.serial_number$,GLOBALPROTECT,$network_activity.sub_type$,$network_activity.future_use_2$,$timestamp=timestamp_pat$,$network_traffic.virtual_system_name$,$session.parent_uid$,$stage$,$authentication_method$,$network_connection_info.tunnel_type$,$user.src_name$,$source_region$,$machine_name$,$public_ip$,$public_ipv6$,$private_ip$,$private_ipv6$,$network_endpoint.host_id$,$device_hardware_info.serial_number$,$client_version$,$client_os$,$client_os_version$,$network_activity.repeat_count$,$reason$,$error$,$description$,$status$,$location$,$login_duration$,$connect_method$,$error_code$,$portal$,$network_activity.sequence_number$,$network_activity.action_flags$",
      rewrites: [
        {
          input:   "device.name",
          output:  "event.source",
          match:   ".*",
          replace: "$0"
        }
      ],
      halt: true
    }, {
      id: "globalprotect-9-1-0", //PAN-OS v9.1.0-9.1.2 GLOBALPROTECT
      attributes: {
        "event.type": "globalprotect",
        "format": "globalprotect-v9.1.3"
      },
      format: "$network_activity.future_use_1$,$network_activity.receive_time$,$device_hardware_info.serial_number$,$network_activity.sequence_number$,$network_activity.action_flags$,GLOBALPROTECT,$network_activity.future_use_2$,$network_activity.future_use_3$,$timestamp=timestamp_pat$,$network_traffic.virtual_system_name$,$session.parent_uid$,$stage$,$authentication_method$,$network_connection_info.tunnel_type$,$user.src_name$,$source_region$,$machine_name$,$public_ip$,$public_ipv6$,$private_ip$,$private_ipv6$,$network_endpoint.host_id$,$device_hardware_info.serial_number$,$client_version$,$client_os$,$client_os_version$,$network_activity.repeat_count$,$reason$,$error$,$description$,$status$,$location$,$login_duration$,$connect_method$,$error_code$,$portal$",
      rewrites: [
        {
          input:   "device.name",
          output:  "event.source",
          match:   ".*",
          replace: "$0"
        }
      ],
      halt: true
    }, {
      id: "decryption-11-0", //PAN-OS v11.0, adds Cluster Name
      attributes: {
        "event.type": "decryption",
        "format": "decryption-v11.0"
      },
      format: "$network_activity.future_use_1$,$network_activity.receive_time$,$firewall.serial_number$,DECRYPTION,$network_activity.sub_type$,$config_version$,$timestamp=timestamp_pat$,$src.ip.address$,$dst.ip.address$,$network_endpoint.nat_src_ip$,$network_endpoint.nat_dst_ip$,$rule.name$,$user.src_name$,$user.dst_name$,$network_activity.app_name$,$network_traffic.virtual_system_name$,$source_zone$,$destination_zone$,$network_interface.inbound_name$,$network_interface.outbound_name$,$network_activity.log_action$,$time_logged$,$session.uid$,$network_activity.repeat_count$,$network_endpoint.src_port$,$network_endpoint.dst_port$,$nenetwork_endpoint.nat_src_port$,$nenetwork_endpoint.nat_dst_port$,$network_connection_info.flag$,$network_connection_info.protocol_name$,$network_activity.action$,$tunnel$,$network_activity.future_use_2$,$network_activity.future_use_3$,$virtual_machine.src_vm_uuid$,$dest_vm_uuid$,$rule.uid$,$stage_client_firewall$,$stage_firewall_server$,$tls_version$,$key_exchange_algorithm$,$encryption_algorithm$,$hash_algorithm$,$rule$,$elliptic_curve$,$error_index$,$root_status$,$chain_status$,$proxy_type$,$cert_serial_number$,$fingerprint$,$certificate.created_time$,$certificate.expiration_time$,$certificate.version$,$certificate.size$,$cn_length$,$issuer_cn_length$,$root_cn_length$,$sni_length$,$cert_flags=value_pat$,$subject_cn$,$issuer_subject_cn$,$root_subject_cn$,$server_name$,$error$,$container.id$,$container.pod_namespace$,$container.pod_name$,$src_edl$,$dest_edl$,$src_dag$,$dest_dag$,$network_activity.time$,$device.src_type$,$device.src_profile$,$device.src_model$,$device.dst_vendor_name$,$device.src_os_edition$,$device.src_os_version$,$network_connection_info.dst_hostname$,$network_connection_info.dst_mac$,$network_activity.sequence_number$,$network_activity.action_flags$,$device.group_hierarchy.level_1$,$device.group_hierarchy.level_2$,$device.group_hierarchy.level_3$,$device.group_hierarchy.level_4$,$firewall.virtual_system_name$,$device.name$,$firewall.virtual_system_id$,$network_activity.sub_category$,$network_activity.category_name$,$network_activity.app_model$,$network_activity.severity$,$network_activity.app_characteristic=value_pat$,$network_activity.container.id$,$network_activity.is_saas$,$network_activity.is_sanctioned$,$network_activity.cluster.name$",
      rewrites: [
        {
          input:   "device.name",
          output:  "event.source",
          match:   ".*",
          replace: "$0"
        }
      ],
      halt: true
    }, {
      id: "decryption-10-1", //PAN-OS v10.1-10.2
      attributes: {
        "event.type": "decryption",
        "format": "decryption-v10.1"
      },
      format: "$network_activity.future_use_1$,$network_activity.receive_time$,$firewall.serial_number$,DECRYPTION,$network_activity.sub_type$,$config_version$,$timestamp=timestamp_pat$,$src.ip.address$,$dst.ip.address$,$network_endpoint.nat_src_ip$,$network_endpoint.nat_dst_ip$,$rule.name$,$user.src_name$,$user.dst_name$,$network_activity.app_name$,$network_traffic.virtual_system_name$,$source_zone$,$destination_zone$,$network_interface.inbound_name$,$network_interface.outbound_name$,$network_activity.log_action$,$time_logged$,$session.uid$,$network_activity.repeat_count$,$network_endpoint.src_port$,$network_endpoint.dst_port$,$nenetwork_endpoint.nat_src_port$,$nenetwork_endpoint.nat_dst_port$,$network_connection_info.flag$,$network_connection_info.protocol_name$,$network_activity.action$,$tunnel$,$network_activity.future_use_2$,$network_activity.future_use_3$,$virtual_machine.src_vm_uuid$,$dest_vm_uuid$,$rule.uid$,$stage_client_firewall$,$stage_firewall_server$,$tls_version$,$key_exchange_algorithm$,$encryption_algorithm$,$hash_algorithm$,$rule$,$elliptic_curve$,$error_index$,$root_status$,$chain_status$,$proxy_type$,$cert_serial_number$,$fingerprint$,$certificate.created_time$,$certificate.expiration_time$,$certificate.version$,$certificate.size$,$cn_length$,$issuer_cn_length$,$root_cn_length$,$sni_length$,$cert_flags=value_pat$,$subject_cn$,$issuer_subject_cn$,$root_subject_cn$,$server_name$,$error$,$container.id$,$container.pod_namespace$,$container.pod_name$,$src_edl$,$dest_edl$,$src_dag$,$dest_dag$,$network_activity.time$,$device.src_type$,$device.src_profile$,$device.src_model$,$device.dst_vendor_name$,$device.src_os_edition$,$device.src_os_version$,$network_connection_info.dst_hostname$,$network_connection_info.dst_mac$,$network_activity.sequence_number$,$network_activity.action_flags$,$device.group_hierarchy.level_1$,$device.group_hierarchy.level_2$,$device.group_hierarchy.level_3$,$device.group_hierarchy.level_4$,$firewall.virtual_system_name$,$device.name$,$firewall.virtual_system_id$,$network_activity.sub_category$,$network_activity.category_name$,$network_activity.app_model$,$network_activity.severity$,$network_activity.app_characteristic=value_pat$,$network_activity.container.id$,$network_activity.is_saas$,$network_activity.is_sanctioned$",
      rewrites: [
        {
          input:   "device.name",
          output:  "event.source",
          match:   ".*",
          replace: "$0"
        }
      ],
      halt: true
    }
  ]
}
